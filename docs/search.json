[
  {
    "objectID": "chapter1.html",
    "href": "chapter1.html",
    "title": "2  Getting to Know Your Data",
    "section": "",
    "text": "2.1 Variables\nBefore we jump into the world of statistical testing, let’s take a moment to refresh our understanding of what a variable is, the different types of variables, and how we can describe them using numerical and graphical methods.\nSo what is a variable?\nThe Australian Bureau of Statistics defines a variable to be “any characteristic, number, or quantity that can be measured or counted.”\nIf you’ve ever tried dieting, you might have recorded your weight on your phone over time. Or maybe you’ve tracked how long your morning commute takes so you know when to leave to arrive on time. In both cases, you are measuring something that changes, and these are examples of variables.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Getting to Know Your Data</span>"
    ]
  },
  {
    "objectID": "chapter1.html#types-of-variables",
    "href": "chapter1.html#types-of-variables",
    "title": "2  Getting to Know Your Data",
    "section": "2.2 Types of Variables",
    "text": "2.2 Types of Variables\nThere are two main types of variables:\n\nNumerical\nCategorical\n\nA numerical variable represents values to describe a measurable quantity. A numerical variable can be either discrete or continuous.\nDiscrete numerical variables take on distinct whole values, and are countable. For example, if we were to look at the at the number of cars in a parking lot, the number of birds in a tree, or the number of times “3” is rolled in a series of die rolls, these are exact values that can be counted and are thus discrete.\nContinuous numerical variables can take on any value within a range of real numbers. In other words, they can be measured to any level of precision. For example, age exists on a continuous scale because, in theory, it can be measured infinitely precisely. Someone could be 10.25, 10.257, or even 10.2576326362 years old. In everyday life, we usually round age to the nearest year, but that does not change the fact that the underlying variable is continuous. Other common examples of continuous numerical variables include weight, height, and time. Can you explain why each of these variables is numerical and continuous?\nA categorical variable, on the other hand, represents categories or labels that describe a quality or characteristic. Categorical variables can be either nominal or ordinal.\nA nominal categorical variable includes observations with no particular order. For example, if you asked ten coworkers for their favorite movie and recorded their answers under a “movies” variable, it would be nominal because there is no inherent sequence or ranking among the movie titles.\nIn an ordinal categorical variable, there is an inherent logical order to the observations. For example, if we collected age groups such as “18–24”, “25–38”, “39–55”, “56–70”, and “70+”, we’re now working with labels that have a built-in order where “18–24” is younger than “25–38”, and so on.\nAnother example might be asking people whether they like ice cream, with options like “strongly agree”, “agree”, “neutral”, “disagree”, and “strongly disagree”. In this case, the order of the options has meaning, even if the distance between them isn’t equal.\nTake a moment to check your understanding with the exercises below.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Getting to Know Your Data</span>"
    ]
  },
  {
    "objectID": "chapter1.html#exercise-checkpoint-1",
    "href": "chapter1.html#exercise-checkpoint-1",
    "title": "2  Getting to Know Your Data",
    "section": "2.3 Exercise Checkpoint 1",
    "text": "2.3 Exercise Checkpoint 1\n\nDescribe the following variables:\na. Eye colour is a discrete numerical variablecontinuous numerical variableordinal categorical variablenominal categorical variable\nb. Temperature is a discrete numerical variableordinal categorical variablenominal categorical variablecontinuous numerical variable\nc. The number of heads in a series of coin flips is a continuous numerical variableordinal categorical variablenominal categorical variablediscrete numerical variable\nd. Education level is a discrete numerical variablecontinuous numerical variablenominal categorical variableordinal categorical variable\ne. Postal Code is a discrete numerical variablecontinuous numerical variableordinal categorical variablenominal categorical variable\nf. Income salary is a discrete numerical variableordinal categorical variablenominal categorical variablecontinuous numerical variable\ng. Number of calls per day is a discrete numerical variablecontinuous numerical variableordinal categorical variablenominal categorical variablediscrete numerical variable",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Getting to Know Your Data</span>"
    ]
  },
  {
    "objectID": "chapter1.html#visually-representing-data",
    "href": "chapter1.html#visually-representing-data",
    "title": "2  Getting to Know Your Data",
    "section": "2.4 Visually Representing Data",
    "text": "2.4 Visually Representing Data\nNow that we’ve covered the main types of variables, we can start thinking about how to visually represent data.\nFirst, we will need to load in some data into R. We will be working with the palmerpenguins package. The palmerpenguins package is a dataset collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.\nIf you have not used this package before, you will need to install it first:\n\ninstall.packages(\"palmerpenguins\")\n\nOnce installed, you will need to load the package into R.\n\nlibrary(palmerpenguins)\n\nNow that we have the package installed, let’s take a look at the variables in the dataset using str().\n\nstr(penguins)\n\ntibble [344 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...\n $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 NA 1 2 1 2 NA NA ...\n $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n\n\nYou might notice that some values are listed as NA. This means there are missing observations. To check for missing values, we can use:\n\nany(is.na(penguins))\n\n[1] TRUE\n\n\nSince this returns TRUE, we know there are missing values in the dataset. Let’s find out how many:\n\nsum(is.na(penguins))\n\n[1] 19\n\n\nThere are 19 missing observations. This can cause problems when generating numerical summaries or running statistical tests. At this stage, to handle this, we can remove the missing values. It’s always best practice to store your cleaned data in a new dataset and leave the original untouched. Note that you should always be careful when removing observations, as even partially filled observations can still provide valuable information.\n\nclean_penguins &lt;- na.omit(penguins)\n\nWe can check the structure again to make sure everything looks good:\n\nstr(clean_penguins)\n\ntibble [333 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...\n $ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...\n $ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...\n $ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 1 2 1 2 1 2 2 ...\n $ year             : int [1:333] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n - attr(*, \"na.action\")= 'omit' Named int [1:11] 4 9 10 11 12 48 179 219 257 269 ...\n  ..- attr(*, \"names\")= chr [1:11] \"4\" \"9\" \"10\" \"11\" ...\n\n\nWe can see that there are eight variables. Three of these are categorical: species, island, and sex. These are stored as factors, where the levels represent the number of distinct labels or groups within each variable. For example, sex has two levels: male and female.\nYou’ll notice that there are four numerical variables: bill_length_mm, bill_depth_mm, flipper_length_mm, and year. If your instinct is that year doesn’t quite fit as right as a numerical variable, you would be right! It is better to treat year as a categorical variable. To convert it, we can use:\n\nclean_penguins$year &lt;- as.factor(clean_penguins$year)\n\nNow if we run str again, we can see that year is now correctly stored as a categorical variable with three levels.\n\nstr(clean_penguins)\n\ntibble [333 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...\n $ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...\n $ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...\n $ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 1 2 1 2 1 2 2 ...\n $ year             : Factor w/ 3 levels \"2007\",\"2008\",..: 1 1 1 1 1 1 1 1 1 1 ...\n - attr(*, \"na.action\")= 'omit' Named int [1:11] 4 9 10 11 12 48 179 219 257 269 ...\n  ..- attr(*, \"names\")= chr [1:11] \"4\" \"9\" \"10\" \"11\" ...\n\n\nIf you’re interested in seeing the unique groupings or labels within a categorical variable, you can use the unique() function.\n\nunique(clean_penguins$year)\n\n[1] 2007 2008 2009\nLevels: 2007 2008 2009\n\n\nThis shows that the data was collected over the years 2007, 2008, and 2009.\nYou can also see from the structure output str() that the penguins dataset is stored as a 333 x 8 tibble, which is a type of data frame in R. This means that there are 333 rows (observations) and 8 columns (variables).\nWe can confirm this using the dim() function.\n\ndim(clean_penguins)\n\n[1] 333   8\n\n\nIf you wish to have a closer look at inspecting the penguins dataset, you can use the View() function to open it in a new tab on RStudio.\n\nView(penguins)\nView(clean_penguins)\n\nNow that we’ve inspected the dataset, we can start thinking about how to visually represent and understand the data.\nWe can describe data using numerical summaries and graphs. Numerical summaries are statistical measures that capture key aspects of a dataset. The way we choose to present these summaries and the graphs that accompany them depends on the type of variable we are working with.\nLet’s start with numerical summaries.\nFor numerical variables, whether continuous or discrete, we can include:\n\nmean\nstandard deviation\nmedian\nminimum\nmaximum\nInterquartile Range (IQR)\n\nIMPORTANT NOTE: When reporting descriptive statistics, always provide appropriate context. If you report a mean, include the standard deviation, and vice versa. If you report a median, include the interquartile range (IQR), and vice versa. Likewise, if you report a maximum value, always include the minimum to give full perspective.\nSome helpful R functions for generating summary statistics:\n\n\n\n\n\n\n\n\nSummary Statistic\nCommand\n\n\n\n\nMean\nmean(...)\n\n\nStandard Deviation\nsd(...)\n\n\nMedian\nmedian(...)\n\n\nMinimum\nmin(...)\n\n\nMaximum\nmax(...)\n\n\nInterquartile Range\nIQR(...)\n\n\nFirst quartile\nquantile(..., 0.25)\n\n\nThird quartile\nquantile(..., 0.75)\n\n\nFive point summary\nsummary(...)\n\n\n\n\n\n\n\nLet’s take a look at calculating descriptive statistics for body_mass_g, which describes the body mass of each penguin in grams.\nNow we can attach the cleaned penguins dataset. Attaching the dataset allows us to call variables directly by name. If we don’t attach it, we can still access variables, but we need to use the full format (for example, clean_penguins$sex).\n\n# Attach cleaned dataset \nattach(clean_penguins)\n\n\n# Let's first calculate the mean and round it to one decimal place\nround(mean(body_mass_g),1)\n\n[1] 4207.1\n\n# Now we can calculate the standard deviation\nround(sd(body_mass_g),1)\n\n[1] 805.2\n\n\nThe average body mass of penguins is 4207.1 g, with a standard deviation of 805.2 g.\n\n# calculate the minimum\nmin(body_mass_g)\n\n[1] 2700\n\n# calculate the maximum\nmax(body_mass_g)\n\n[1] 6300\n\n\nThe minimum observed body mass is 2700 g, and the maximum observed body mass is 6300 g.\n\n# calculate median\nmedian(body_mass_g)\n\n[1] 4050\n\n# calculate IQR\n## first quantile\nquantile(body_mass_g, 0.25)\n\n 25% \n3550 \n\n## third quantile \nquantile(body_mass_g, 0.75)\n\n 75% \n4775 \n\n\nThe median body mass is 4050 g, with an interquartile range from 3350 g to 4775 g.\nThe summary() function lets us quickly gather all of this information at once.\n\n# Calculate 5-point summary\nsummary(body_mass_g)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   2700    3550    4050    4207    4775    6300 \n\n\nNow that we’ve explored numerical summaries, let’s move on to graphing.\nWhen you have one numerical variable, whether discrete or continuous, a histogram is a great way to visualise its distribution.\nWe’ll use the ggplot2 package for this. If you haven’t used it before, you’ll need to install it first.\n\n# Install the package\ninstall.packages(ggplot2)\n\nOnce installed, you can load the package and start plotting.\n\n# Load the library\nlibrary(ggplot2)\n\n# We can plot the histogram\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram()\n\n\n\n\n\n\n\n\nThe histogram looks a bit plain without any color, and the x-axis label isn’t very informative. Let’s add some color, fix the labels, and give it a clean white background.\n\n# We can plot the histogram\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram(fill=\"orangered\", bins=30) +\n  labs(x=\"Body Mass of Penguins (g)\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nWhat if we’re interested in how body mass relates to flipper length? In this case, we’re working with two continuous numerical variables, so a scatterplot would be a good choice.\n\nggplot(clean_penguins, aes(x=body_mass_g, y=flipper_length_mm))+\n  geom_point()\n\n\n\n\n\n\n\n\nLike we did with the histogram, we can add color, change the shape of the points, and include informative labels.\n\nggplot(clean_penguins, aes(x=body_mass_g, y=flipper_length_mm))+\n  geom_point(fill=\"aquamarine\", col=\"aquamarine4\", pch=21, size=2.5)+\n  labs(x=\"Body Mass of Penguins (g)\", y=\"Flipper Length of Penguins (mm)\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can see that as the body mass of a penguin increases, its flipper length also tends to increase. This suggests a strong positive linear relationship.\nNow, let’s look at a case where we have one categorical variable and one numerical variable. A boxplot is a great choice here. Let’s see how body mass differs between penguin species.\n\nggplot(clean_penguins, aes(x=species, y=body_mass_g))+\n  geom_boxplot(fill = c(\"coral2\", \"chartreuse2\", \"cadetblue2\"),\n               col = c(\"coral3\", \"chartreuse4\", \"cadetblue4\")) +\n  labs(x=\"Species of Penguin\", y=\"Body Mass (g)\")\n\n\n\n\n\n\n\n\nWe can see that Gentoo penguins have a noticeably higher median body mass compared to Chinstrap and Adelie penguins. The interquartile range (the box) for the Gentoo species does not overlap with the others, suggesting there may be a significant difference between them.\nSince we’re now considering species, let’s also take a look at how many penguins were observed in each species. Because we’re dealing with a categorical variable, a bar plot is appropriate.\n\nggplot(clean_penguins, aes(x = species)) +\n  geom_bar(fill = c(\"coral2\", \"chartreuse2\", \"cadetblue2\"),\n               col = c(\"coral3\", \"chartreuse4\", \"cadetblue4\")) +\n  labs(x = \"Penguin Species\", y = \"Count\") +\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can also explore proportions to understand how each species contributes to the total sample.\n\nggplot(data=clean_penguins, aes(x=species))+\n  geom_bar(fill = c(\"coral2\", \"chartreuse2\", \"cadetblue2\"),\n               col = c(\"coral3\", \"chartreuse4\", \"cadetblue4\"), \n           aes(y=after_stat(prop), group=1))+\n  labs(x=\"Penguin Species\", y=\"Proportion\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nAdelie penguins make up a much larger proportion of the sample, while Chinstrap penguins account for the smallest. It’s important to consider how such imbalances in your dataset could influence your interpretation.\nWe can also generate a mosaic plot for species. To do so, we will need to install ggmosaic.\n\ninstall.packages(\"ggmosaic\")\n\n\nlibrary(ggmosaic)\n\nggplot(data=clean_penguins, aes(col=species))+\n  geom_mosaic(aes(x=product(species)), fill=c(\"coral2\", \"chartreuse2\", \"cadetblue2\"))+\n  theme_bw() \n\n\n\n\n\n\n\n\nThe wider the tile, the greater the proportion that species contributes. Adelie has the widest tile, which confirms it makes up the largest share of the sample.\nWhat if we want to look at penguin species by the island where they were observed? We are now dealing with two categorical variables. Mosaic plots work well here too.\n\nggplot(clean_penguins) +\n  geom_mosaic(aes(x = product(island, species)), \n              fill = rep(c(\"coral2\", \"chartreuse2\", \"cadetblue2\"),3)) +\n  theme_bw()\n\n\n\n\n\n\n\n\nFrom this plot you can see:\n\nAdelie appear on Biscoe, Dream, and Torgersen in roughly similar counts.\nChinstrap are observed only on Dream.\nGentoo are observed only on Biscoe.\n\nThese patterns help explain why Adelie dominate overall, and they also show that species presence varies by island.\nBe sure to detach() your dataset before you move onto the exercises.\n\ndetach(clean_penguins)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Getting to Know Your Data</span>"
    ]
  },
  {
    "objectID": "chapter1.html#exercise-checkpoint-2",
    "href": "chapter1.html#exercise-checkpoint-2",
    "title": "2  Getting to Know Your Data",
    "section": "2.5 Exercise Checkpoint 2",
    "text": "2.5 Exercise Checkpoint 2\n\nNow that you are more comfortable generating plots and summary statistics in R, it is a good time to test your skills on a new dataset, the built-in iris dataset. This dataset is already preloaded in RStudio, so there is no need to import anything.\nTo make sure it is available, you can view it by running\n\nView(iris)\n\nThis will open the dataset in a new tab in RStudio so you can explore its structure and variables before starting your analysis.\na. How many variables are in the iris dataset? \nb. How many observations are in the iris dataset? \nc. How many categorical variables are in the iris dataset? \nd. How many numerical variables are in the iris dataset? \ne. How many species are in the iris dataset? \nf. What are the names of the three species in the iris dataset? Please list them in alphabetical order, separated by commas (for example: x, y, z) \ng. Is Species nominal or ordinal? \nh. Is Sepal.Length continuous or discrete? \ni. What is the mean sepal width of iris varieties rounded to one decimal place? \nj. What is an appropriate plot to visualise petal width against species? \nk. What is an appropriate plot to visualise petal width against sepal width?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Getting to Know Your Data</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee @knuth84 for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "4  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "tablesforR.html",
    "href": "tablesforR.html",
    "title": "2  Preparing Data for Tables",
    "section": "",
    "text": "Now that we’ve covered the main types of variables, we can start thinking about how to prepare and visually represent data with figures and tables. In this section, we will focus on preparing data for tables.\nIn R, datasets are stored as dataframes, which are objects made up of rows and columns. Each row corresponds to an individual observation, while each column represents the variable that is being measured. There are several ways R stores variables: character for text, factor for categorical, integer for whole numbers, numeric for decimals, and logical for booleans (TRUE/FALSE).\nCleaning data can be the most time-consuming, yet arguably the most important, part of analysing data! Generally, it is\n\nwide format to long format\n\nTo understand R, we will examine these concepts using real-world datasets.\n\nNAPLAN\n\n\n\n\n\nPhoto by N. K. on Unsplash\nThe first dataset to be explored is the NAPLAN dataset. NAPLAN stands for the National Assessment Program - Literacy and Numeracy, and is an annual national assessment for all students in year 3, 5, 7, and 9. The assessment is designed to evaluate whether students are building essential literacy and numeracy skills (https://www.nap.edu.au/naplan/faqs/naplan–general).\nTo load in the dataset, we can use the read.csv() function.\n\nnaplan &lt;- read.csv(\"Data-sets/naplan_reading.csv\")\n\nTry doing this yourself.\n\n\n\n\n\n\n\n\n\n\nnaplan &lt;- read.csv(\"Data-sets/naplan_reading.csv\")\nnaplan &lt;- read.csv(\"Data-sets/naplan_reading.csv\")\n\n\n\n\n\nNow that we have the dataset loaded in, let’s take a look at the variables in the dataset using str().\n\n\n\n\n\n\n\n\n\n\nstr(naplan)\nstr(naplan)\n\n\n\n\n\nIn the top line, we can see that there are 3000 observations and 11 variables.\nWe can confirm this using the dim() function\n\n\n\n\n\n\n\n\n\n\ndim(naplan)\ndim(naplan)\n\n\n\n\n\nUsing the names() function, we can see the variable names.\n\n\n\n\n\n\n\n\n\n\nnames(naplan)\nnames(naplan)\n\n\n\n\n\nThe first column gives us the variables, the second column gives us the type of variable, and the third column gives us individual observations for each row. However, we can see school_type is stored as a chr or character (text) variable. Text variables are very common when you encounter surveys that have customer feedback, for example, as each response will be unique from one another.\nIt is important to check that your variables are stored correctly. We can see certain variables like reading time at home is an integer, which matches our expectations.\nYou can use the unique() function to see the unique groupings or labels within a categorical variable. In our case, we can use it to confirm if our suspicions that school_type is categorical. To call a specific variable, we call the dataset followed by $ and then the variable name.\n\nunique(naplan$school_type)\n\n[1] \"Government\"  \"Independent\" \"Catholic\"   \n\n\nThere are only 3 unique labels, which strongly suggests that school type is a nominal categorical variable. If it were truly a text variable, we might see thousands of unique labels.\nWe can manually convert the variable to categorical using as.factor():\n\nnaplan$school_type &lt;- as.factor(naplan$school_type)\n\n\nstr(naplan)\n\n'data.frame':   3000 obs. of  11 variables:\n $ student_id          : int  1 2 3 4 5 6 7 8 9 10 ...\n $ school_id           : int  51 26 14 21 33 26 37 41 8 60 ...\n $ grade               : chr  \"Year 7\" \"Year 3\" \"Year 7\" \"Year 3\" ...\n $ reading_time_home   : int  70 70 30 0 20 25 5 90 45 10 ...\n $ parent_education    : chr  \"Certificate/Diploma\" \"Year 12\" \"Bachelor degree\" \"Bachelor degree\" ...\n $ school_type         : Factor w/ 3 levels \"Catholic\",\"Government\",..: 2 2 2 3 2 2 2 2 2 2 ...\n $ gender              : chr  \"Female\" \"Female\" \"Male\" \"Female\" ...\n $ birth_months        : chr  \"Aug\" \"Apr\" \"Jul\" \"Sep\" ...\n $ n_siblings          : int  2 1 1 1 0 1 3 2 1 3 ...\n $ ses_index           : num  0.87 0.11 1.14 0.66 0.27 -0.95 -0.65 1.01 -0.6 -1.14 ...\n $ naplan_reading_score: int  724 439 631 491 635 592 449 484 730 528 ...\n\n\nNow we can see school_type is a factor with 3 levels (or 3 unique labels).\nAlternatively, we can also convert all strings (text) to categorical variables with the stringsAsFactors argument when we read in the dataset.\n\nnaplan &lt;- read.csv(\"Data-sets/naplan_reading.csv\",\n                   stringsAsFactors = TRUE)\n\n\nstr(naplan)\n\n'data.frame':   3000 obs. of  11 variables:\n $ student_id          : int  1 2 3 4 5 6 7 8 9 10 ...\n $ school_id           : int  51 26 14 21 33 26 37 41 8 60 ...\n $ grade               : Factor w/ 4 levels \"Year 3\",\"Year 5\",..: 3 1 3 1 4 4 1 3 4 3 ...\n $ reading_time_home   : int  70 70 30 0 20 25 5 90 45 10 ...\n $ parent_education    : Factor w/ 5 levels \"Bachelor degree\",..: 2 5 1 1 5 4 4 1 4 4 ...\n $ school_type         : Factor w/ 3 levels \"Catholic\",\"Government\",..: 2 2 2 3 2 2 2 2 2 2 ...\n $ gender              : Factor w/ 2 levels \"Female\",\"Male\": 1 1 2 1 2 1 1 1 1 2 ...\n $ birth_months        : Factor w/ 12 levels \"Apr\",\"Aug\",\"Dec\",..: 2 1 6 12 3 10 2 12 11 8 ...\n $ n_siblings          : int  2 1 1 1 0 1 3 2 1 3 ...\n $ ses_index           : num  0.87 0.11 1.14 0.66 0.27 -0.95 -0.65 1.01 -0.6 -1.14 ...\n $ naplan_reading_score: int  724 439 631 491 635 592 449 484 730 528 ...\n\n\nAs seen above, all the chr variables have been converted to Factor, which is how the variables should be stored. Note that there might be times where you need a variable stored as chr, so you should always be sure of what you’re checking.\nWe can now attach the dataset. Attaching the dataset means we can call variables directly without using $. For instance, we can call school_type directly as opposed to naplan$school_type.\n\nattach(naplan)\n\nIf we type naplan directly in, we can see the content.\n\nnaplan\n\nAlternatively, we can use the View() function to open up a new tab in RStudio with the dataset.\n\nView(naplan)\n\nWe can also select parts of the dataframe. This can be very useful for deciding which data you want to include a table. In R, we subset by calling the dataset followed by [,] . Writing a blank space before the comma indicates that all rows are includes, while a blank space after the comma indicates that all columns are included. For example, [,3] selects the third column of a dataframe. If we want to select the first three columns, we can write:\nTry selecting the first three rows and first three columns of the naplan dataset. You select a number of rows or columns using :. For example, to select rows 3-4, simply type naplan[3:4,]\n\n\n\n\n\n\n\n\n\n\nnaplan[1:3,1:3]\nnaplan[1:3,1:3]\n\n\n\n\n\nNow try selecting only rows 5-6.\n\n\n\n\n\n\n\n\n\n\nnaplan[5:6,]\nnaplan[5:6,]\n\n\n\n\n\nWe can even select rows based on logical tests on the values of one or more variables.\nFor instance, let’s say we want all observations where reading time is greater than 45 mins. We can do this by typing naplan[reading_time_home&gt;45, ].\nTry having a go below by selecting rows with reading times greater than 30 mins AND where students havea reading score greater than 800. Hint; you will need to use the logical operator &\n\n\n\n\n\n\n\n\n\n\nnaplan[reading_time_home &gt; 30 & naplan_reading_score &gt; 860,]\nnaplan[reading_time_home &gt; 30 & naplan_reading_score &gt; 860,]\n\n\n\n\n\nThe dyplr package can simplify this process. Some helpful functions include select, mutate, and filter. You can load in tidyverse which has dplyr built in, or load in dyplr directly.\n\nlibrary(tidyverse)\n\nLet’s filter our data by Year 3 students with reading times at home above 100 mins.\n\nnaplan %&gt;%\n  filter(grade == \"Year 3\" & reading_time_home &gt; 100)\n\n  student_id school_id  grade reading_time_home parent_education school_type\n1        976         3 Year 3               120  Bachelor degree  Government\n2       1005        44 Year 3               120  Bachelor degree Independent\n3       1512        38 Year 3               115 Year 10 or below  Government\n4       2378        34 Year 3               115          Year 12    Catholic\n5       2473        52 Year 3               105  Bachelor degree  Government\n  gender birth_months n_siblings ses_index naplan_reading_score\n1 Female          Aug          3      0.24                  539\n2   Male          Mar          2      2.20                  600\n3   Male          Aug          3     -1.21                  533\n4 Female          Jul          3      0.07                  319\n5 Female          Sep          1      1.02                  455\n\n\nAs we saw above, student_id and school_id is stored as integers. As these numbers actually represent unique labels, they should be treated as categorical. We can mutate student_id and school_id to factor variables.\n\nnaplan &lt;- naplan %&gt;%\n  mutate(across(c(school_id, student_id), as.factor))\n\n\nstr(naplan)\n\n'data.frame':   3000 obs. of  11 variables:\n $ student_id          : Factor w/ 3000 levels \"1\",\"2\",\"3\",\"4\",..: 1 2 3 4 5 6 7 8 9 10 ...\n $ school_id           : Factor w/ 60 levels \"1\",\"2\",\"3\",\"4\",..: 51 26 14 21 33 26 37 41 8 60 ...\n $ grade               : Factor w/ 4 levels \"Year 3\",\"Year 5\",..: 3 1 3 1 4 4 1 3 4 3 ...\n $ reading_time_home   : int  70 70 30 0 20 25 5 90 45 10 ...\n $ parent_education    : Factor w/ 5 levels \"Bachelor degree\",..: 2 5 1 1 5 4 4 1 4 4 ...\n $ school_type         : Factor w/ 3 levels \"Catholic\",\"Government\",..: 2 2 2 3 2 2 2 2 2 2 ...\n $ gender              : Factor w/ 2 levels \"Female\",\"Male\": 1 1 2 1 2 1 1 1 1 2 ...\n $ birth_months        : Factor w/ 12 levels \"Apr\",\"Aug\",\"Dec\",..: 2 1 6 12 3 10 2 12 11 8 ...\n $ n_siblings          : int  2 1 1 1 0 1 3 2 1 3 ...\n $ ses_index           : num  0.87 0.11 1.14 0.66 0.27 -0.95 -0.65 1.01 -0.6 -1.14 ...\n $ naplan_reading_score: int  724 439 631 491 635 592 449 484 730 528 ...\n\n\nWe can combine several of these pipelines together. For example, we can select student_id and school_id, rename student_id to student and school_id to school, then mutate them back to integers and store the result in a new dataset called naplan_new.\n\nnaplan_new &lt;- naplan %&gt;%\n  select(student = student_id,\n         school = school_id) %&gt;%\n  mutate(across(c(school, student), as.integer))\n\nstr(naplan_new)\n\n'data.frame':   3000 obs. of  2 variables:\n $ student: int  1 2 3 4 5 6 7 8 9 10 ...\n $ school : int  51 26 14 21 33 26 37 41 8 60 ...\n\n\nWe can summarise the content of the dataframe as well.\n\nsummary(naplan)\n\n   student_id     school_id       grade     reading_time_home\n 1      :   1   38     :  87   Year 3:735   Min.   :  0.00   \n 2      :   1   20     :  83   Year 5:771   1st Qu.:  5.00   \n 3      :   1   41     :  83   Year 7:745   Median : 15.00   \n 4      :   1   26     :  81   Year 9:749   Mean   : 21.62   \n 5      :   1   60     :  81                3rd Qu.: 30.00   \n 6      :   1   48     :  80                Max.   :120.00   \n (Other):2994   (Other):2505                                 \n            parent_education      school_type      gender      birth_months \n Bachelor degree    :771     Catholic   : 540   Female:1451   Dec    : 325  \n Certificate/Diploma:701     Government :2023   Male  :1549   Aug    : 314  \n Postgraduate       :297     Independent: 437                 Jan    : 300  \n Year 10 or below   :466                                      Sep    : 299  \n Year 12            :765                                      Jul    : 296  \n                                                              Nov    : 296  \n                                                              (Other):1170  \n   n_siblings      ses_index       naplan_reading_score\n Min.   :0.000   Min.   :-2.3200   Min.   :177.0       \n 1st Qu.:1.000   1st Qu.:-0.1100   1st Qu.:491.0       \n Median :2.000   Median : 0.5300   Median :562.0       \n Mean   :1.899   Mean   : 0.5246   Mean   :558.5       \n 3rd Qu.:3.000   3rd Qu.: 1.1500   3rd Qu.:618.2       \n Max.   :5.000   Max.   : 3.4100   Max.   :900.0       \n                                                       \n\n\nYou might notice that the summary doesn’t quite work for categorical variables.\nWe can use tapply() and with() to summarise a quantitative variable by a qualitative variable.\n\nwith(naplan, tapply(naplan_reading_score, grade, mean))\n\n  Year 3   Year 5   Year 7   Year 9 \n457.1687 539.7821 594.5785 641.1722 \n\n\naggregate() allows you to summarise by one or more categorical variables, while tapply can only summarise one variable at a time.\n\naggregate(naplan[,c(4,11)], list(grade),mean)\n\n  Group.1 reading_time_home naplan_reading_score\n1  Year 3          21.59184             457.1687\n2  Year 5          21.83528             539.7821\n3  Year 7          22.24832             594.5785\n4  Year 9          20.80774             641.1722\n\n\n\naggregate(naplan[,c(4,11)], list(Grade = grade),mean)\n\n   Grade reading_time_home naplan_reading_score\n1 Year 3          21.59184             457.1687\n2 Year 5          21.83528             539.7821\n3 Year 7          22.24832             594.5785\n4 Year 9          20.80774             641.1722\n\n\n\naggregate(naplan[,c(4,11)], list(Grade = grade, \"Parent Education\" = parent_education),mean)\n\n    Grade    Parent Education reading_time_home naplan_reading_score\n1  Year 3     Bachelor degree          21.35000             478.5500\n2  Year 5     Bachelor degree          19.63054             564.7783\n3  Year 7     Bachelor degree          21.15591             618.3065\n4  Year 9     Bachelor degree          18.48901             653.3187\n5  Year 3 Certificate/Diploma          18.17919             457.6127\n6  Year 5 Certificate/Diploma          21.78977             536.1705\n7  Year 7 Certificate/Diploma          23.15217             595.2554\n8  Year 9 Certificate/Diploma          22.44048             642.1786\n9  Year 3        Postgraduate          20.06494             487.3117\n10 Year 5        Postgraduate          20.19481             575.4026\n11 Year 7        Postgraduate          23.10606             628.7727\n12 Year 9        Postgraduate          17.20779             684.5325\n13 Year 3    Year 10 or below          22.47475             431.2323\n14 Year 5    Year 10 or below          25.49587             505.1983\n15 Year 7    Year 10 or below          21.30435             558.1391\n16 Year 9    Year 10 or below          21.48855             609.4809\n17 Year 3             Year 12          25.18817             435.0914\n18 Year 5             Year 12          22.55155             524.3351\n19 Year 7             Year 12          22.70619             581.1546\n20 Year 9             Year 12          22.56545             632.9686\n\n\n\n\nExercise: Palmer Penguins\n\n\n\n\n\nPhoto by Derek Oyen on Unsplash\nFirst, we will need to load in some data into R. We will be working with the palmerpenguins package. The palmerpenguins package is a dataset collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.\nIf you have not used this package before, you will need to install it first.\n\ninstall.packages(\"palmerpenguins\")\n\nOnce installed, you will need to load the package into R.\n\n\n\n\n\n\n\n\n\n\n# Load in the `palmerpenguins` package\nlibrary(palmerpenguins)\n# Load in the `palmerpenguins` package\nlibrary(palmerpenguins)\n\n\n\n\n\nNow that we have the package installed, let’s take a look at the variables in the dataset using str() on the penguins dataset.\n\n\n\n\n\n\n\n\n\n\n# Call str() on `penguins`\nstr(penguins)\n# Call str() on `penguins`\nstr(penguins)\n\n\n\n\n\nYou might notice that some values are listed as NA. This means there are missing observations. To check for missing values, try using the embedded any(is.na()) function.\n\n\n\n\n\n\n\n\n\n\n# Try using any(is.na()) on the `penguins` dataset.\nany(is.na(penguins))\n# Try using any(is.na()) on the `penguins` dataset.\nany(is.na(penguins))\n\n\n\n\n\nSince this returns TRUE, we know there are missing values in the dataset. Let’s find out how many.\n\n\n\n\n\n\n\n\n\n\n# Try using sum(is.na()) on the `penguins` dataset.\nsum(is.na(penguins))\n# Try using sum(is.na()) on the `penguins` dataset.\nsum(is.na(penguins))\n\n\n\n\n\nThere are  missing observations. This can cause problems when generating numerical summaries or running statistical tests. At this stage, to handle this, we can remove the missing values. It’s always best practice to store your cleaned data in a new dataset and leave the original untouched. Note that you should always be careful when removing observations, as even partially filled observations can still provide valuable information.\n\n\n\n\n\n\n\n\n\n\nclean_penguins &lt;- na.omit(penguins)\nclean_penguins &lt;- na.omit(penguins)\n\n\n\n\n\nWe can check the structure again to make sure everything looks good:\n\nstr(clean_penguins)\n\ntibble [333 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:333] 39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...\n $ bill_depth_mm    : num [1:333] 18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...\n $ flipper_length_mm: int [1:333] 181 186 195 193 190 181 195 182 191 198 ...\n $ body_mass_g      : int [1:333] 3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 1 2 1 2 1 2 2 ...\n $ year             : int [1:333] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n - attr(*, \"na.action\")= 'omit' Named int [1:11] 4 9 10 11 12 48 179 219 257 269 ...\n  ..- attr(*, \"names\")= chr [1:11] \"4\" \"9\" \"10\" \"11\" ...\n\n\nWe can see that there are eight variables. Three of these are categorical: species, island, and sex. These are stored as factors, where the levels represent the number of distinct labels or groups within each variable. For example, sex has two levels: male and female.\nYou’ll notice that there are four numerical variables: bill_length_mm, bill_depth_mm, flipper_length_mm, and year. If your instinct is that year doesn’t quite fit as right as a numerical variable, you would be right! It is better to treat year as a categorical variable.\nHow do we manually convert year to a factor?\n\n\n\n\n\n\n\n\n\n\nclean_penguins$year &lt;- as.factor(clean_penguins$year)\nclean_penguins$year &lt;- as.factor(clean_penguins$year)\n\n\n\n\n\nNow if we run class(), we can see that year is now correctly stored as a categorical variable with three levels.\n\nclass(clean_penguins$year)\n\n[1] \"factor\"\n\n\nHow can we check the unique groupings or labels within year?\n\n\n\n\n\n\n\n\n\n\nunique(clean_penguins$year)\nunique(clean_penguins$year)\n\n\n\n\n\nThis shows that the data was collected over the years , , and  (ascending order).\nYou can also see from the structure output str() that the penguins dataset is stored as a 333 x 8 tibble, which is a type of data frame in R. This means that there are 333 rows (observations) and 8 columns (variables).\nCheck the dimensions of the cleaned dataset to confirm this.\n\n\n\n\n\n\n\n\n\n\ndim(clean_penguins)\ndim(clean_penguins)\n\n\n\n\n\nIf you wish to have a closer look at inspecting the penguins dataset, you can use the View() function to open it in a new tab on RStudio.\n\nView(penguins)\nView(clean_penguins)\n\n\n\nTables\nNow that we’ve inspected the dataset, we can start thinking about how to visually represent and understand the data.\nAs we have learnt\n\nlibrary(gt)\nlibrary(tidyverse)\nlibrary(kableExtra)\n\n\nnaplan %&gt;% \n  dplyr::filter(reading_time_home &gt; 30 & naplan_reading_score &gt; 800) %&gt;%\n  gt() %&gt;%\n  tab_header(title = \"Naplan\") %&gt;%\n  fmt_number(decimals=2) %&gt;%\n  cols_label(\n    student_id = md(\"***Student ID***\"),\n    school_id = md(\"***School ID***\"),\n    grade = md(\"***Grade***\"),\n    reading_time_home = md(\"***Reading Time***\"),\n    parent_education = md(\"***Parent Education***\"),\n    school_type = md(\"***School Type***\"),\n    gender = md(\"***Gender***\"),\n    birth_months = md(\"***Birth Month***\"),\n    n_siblings = md(\"***Number of Siblings***\"),\n    ses_index = md(\"***SES Index***\"),\n    naplan_reading_score = md(\"***Reading Score***\")\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNaplan\n\n\nStudent ID\nSchool ID\nGrade\nReading Time\nParent Education\nSchool Type\nGender\nBirth Month\nNumber of Siblings\nSES Index\nReading Score\n\n\n\n\n493\n1\nYear 9\n65.00\nYear 12\nIndependent\nMale\nAug\n0.00\n1.05\n900.00\n\n\n584\n1\nYear 9\n40.00\nCertificate/Diploma\nIndependent\nFemale\nSep\n1.00\n0.68\n900.00\n\n\n626\n35\nYear 9\n40.00\nBachelor degree\nGovernment\nFemale\nDec\n2.00\n1.16\n804.00\n\n\n741\n42\nYear 9\n105.00\nYear 12\nGovernment\nMale\nAug\n5.00\n−0.44\n900.00\n\n\n1118\n42\nYear 9\n95.00\nCertificate/Diploma\nGovernment\nMale\nJul\n2.00\n−0.28\n883.00\n\n\n1168\n31\nYear 9\n60.00\nPostgraduate\nCatholic\nFemale\nAug\n2.00\n2.19\n871.00\n\n\n1174\n35\nYear 9\n65.00\nYear 12\nGovernment\nMale\nAug\n2.00\n−0.33\n900.00\n\n\n1447\n23\nYear 9\n75.00\nYear 12\nIndependent\nMale\nSep\n2.00\n0.30\n900.00\n\n\n1792\n5\nYear 9\n70.00\nYear 12\nGovernment\nMale\nAug\n1.00\n0.52\n900.00\n\n\n1906\n5\nYear 9\n70.00\nYear 10 or below\nGovernment\nMale\nJan\n5.00\n−0.71\n887.00\n\n\n1952\n35\nYear 9\n75.00\nYear 12\nGovernment\nMale\nAug\n1.00\n−0.17\n900.00\n\n\n2122\n5\nYear 9\n55.00\nPostgraduate\nGovernment\nMale\nJul\n3.00\n1.87\n900.00\n\n\n2359\n35\nYear 9\n60.00\nBachelor degree\nGovernment\nFemale\nDec\n5.00\n1.33\n900.00\n\n\n2425\n47\nYear 9\n50.00\nPostgraduate\nIndependent\nFemale\nAug\n2.00\n2.02\n866.00\n\n\n2691\n55\nYear 9\n80.00\nYear 12\nGovernment\nFemale\nDec\n2.00\n−0.18\n837.00\n\n\n2712\n31\nYear 9\n60.00\nYear 12\nCatholic\nMale\nDec\n2.00\n0.81\n809.00\n\n\n2756\n53\nYear 9\n55.00\nYear 10 or below\nGovernment\nFemale\nMar\n1.00\n−0.40\n840.00\n\n\n\n\n\n\n\n\nnaplan %&gt;% \n  filter(gender == \"Female\", school_type == \"Independent\") %&gt;%\n  arrange(desc(naplan_reading_score)) %&gt;%\n  slice_head(n = 10) %&gt;%\n  gt() %&gt;%\n  tab_header(title = \"Naplan\") %&gt;%\n  fmt_number(decimals = 2) %&gt;%\n  cols_label(\n    student_id = md(\"***Student ID***\"),\n    school_id = md(\"***School ID***\"),\n    grade = md(\"***Grade***\"),\n    reading_time_home = md(\"***Reading Time***\"),\n    parent_education = md(\"***Parent Education***\"),\n    school_type = md(\"***School Type***\"),\n    gender = md(\"***Gender***\"),\n    birth_months = md(\"***Birth Month***\"),\n    n_siblings = md(\"***Number of Siblings***\"),\n    ses_index = md(\"***SES Index***\"),\n    naplan_reading_score = md(\"***Reading Score***\")\n  ) %&gt;%\n  data_color(\n    columns = naplan_reading_score,\n    method = \"numeric\",\n    palette = \"viridis\",\n    domain = c(0, 1000),\n    reverse = TRUE\n  ) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = \"gray95\"),\n      cell_borders(sides = c(\"l\", \"r\"), color = \"gray50\", weight = px(3))\n    ),\n    locations = cells_body(columns = -naplan_reading_score)\n  ) %&gt;%\n  tab_style(\n    style = cell_fill(color = \"gray98\"),\n    locations = cells_title()\n  ) %&gt;%\n  tab_style(\n    style = list(cell_fill(color = \"gray35\"), cell_text(color = \"white\")),\n    locations = list(cells_footnotes(), cells_source_notes())\n  ) %&gt;%\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_title(groups = \"title\")\n  ) %&gt;% \n  tab_style(\n    style = cell_borders(\n      sides = c(\"t\", \"b\"),\n      color = \"darkgrey\",\n      weight = px(3)\n    ),\n    locations = list(cells_column_labels(), cells_stubhead())\n  ) %&gt;%\ntab_footnote(\n    footnote = \"SES Index represents \",\n    locations = cells_column_labels(columns = ses_index)\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNaplan\n\n\nStudent ID\nSchool ID\nGrade\nReading Time\nParent Education\nSchool Type\nGender\nBirth Month\nNumber of Siblings\nSES Index\n1\nReading Score\n\n\n\n\n584\n1\nYear 9\n40.00\nCertificate/Diploma\nIndependent\nFemale\nSep\n1.00\n0.68\n900.00\n\n\n2425\n47\nYear 9\n50.00\nPostgraduate\nIndependent\nFemale\nAug\n2.00\n2.02\n866.00\n\n\n1007\n1\nYear 9\n25.00\nBachelor degree\nIndependent\nFemale\nApr\n0.00\n1.09\n831.00\n\n\n887\n1\nYear 7\n50.00\nBachelor degree\nIndependent\nFemale\nJul\n1.00\n0.85\n800.00\n\n\n2166\n2\nYear 7\n60.00\nBachelor degree\nIndependent\nFemale\nMay\n1.00\n2.40\n800.00\n\n\n2610\n23\nYear 9\n35.00\nBachelor degree\nIndependent\nFemale\nOct\n1.00\n1.44\n796.00\n\n\n305\n1\nYear 9\n35.00\nCertificate/Diploma\nIndependent\nFemale\nApr\n3.00\n0.46\n788.00\n\n\n1220\n47\nYear 9\n35.00\nCertificate/Diploma\nIndependent\nFemale\nJul\n5.00\n0.76\n782.00\n\n\n133\n47\nYear 9\n55.00\nYear 10 or below\nIndependent\nFemale\nSep\n3.00\n0.36\n780.00\n\n\n1383\n47\nYear 9\n30.00\nCertificate/Diploma\nIndependent\nFemale\nSep\n2.00\n1.53\n774.00\n\n\n\n1 SES Index represents\n\n\n\n\n\n\n\n\n\nnaplan |&gt;\n  dplyr::group_by(gender) |&gt;\n  dplyr::summarise(\n    mean_score = mean(naplan_reading_score, na.rm = TRUE),\n    mean_ses   = mean(ses_index, na.rm = TRUE),\n    .groups = \"drop\"\n  ) |&gt;\n  tidyr::pivot_wider(\n    names_from = gender,\n    values_from = c(mean_score, mean_ses)\n  ) |&gt;\n  gt() |&gt;\n  fmt_number(columns = everything(), decimals = 2) |&gt;\n  tab_spanner(\n    label = \"Female\",\n    columns = matches(\"_Female$\")\n  ) |&gt;\n  tab_spanner(\n    label = \"Male\",\n    columns = matches(\"_Male$\")\n  ) |&gt;\n  cols_label(\n    matches(\"mean_score\") ~ \"Reading Score&lt;br&gt;Average\",\n    matches(\"mean_ses\") ~ \"SES Index&lt;br&gt;Average\",\n    .fn=md\n  ) |&gt;\n  cols_width(everything() ~ px(120))\n\n\n\n\n\n\n\nFemale\nMale\n\n\nReading ScoreAverage\nSES IndexAverage\nReading ScoreAverage\nSES IndexAverage\n\n\n\n\n563.00\n0.50\n554.21\n0.55\n\n\n\n\n\n\n\n\nlibrary(gtsummary)\n\n\nnaplan |&gt;\n  tbl_summary(\n    by = gender,\n    include=c(grade, reading_time_home, naplan_reading_score),\n    statistic=list(all_continuous()~\"{mean} ({sd})\"),\n    digits=list(naplan_reading_score = c(0,1),\n                reading_time_home = c(0,1))\n  )\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nFemale\nN = 1,451\n1\nMale\nN = 1,549\n1\n\n\n\n\ngrade\n\n\n\n\n\n\n    Year 3\n350 (24%)\n385 (25%)\n\n\n    Year 5\n378 (26%)\n393 (25%)\n\n\n    Year 7\n356 (25%)\n389 (25%)\n\n\n    Year 9\n367 (25%)\n382 (25%)\n\n\nreading_time_home\n22 (22.9)\n21 (22.7)\n\n\nnaplan_reading_score\n563 (95.7)\n554 (92.0)\n\n\n\n1\nn (%); Mean (SD)\n\n\n\n\n\n\n\n\n\nnaplan |&gt;\n  tbl_summary(\n    include=c(reading_time_home, naplan_reading_score),\n    type=all_continuous() ~ \"continuous2\",\n    statistic=list(all_continuous()~c(\"{median} ({p25}, {p75})\", \"{min}, {max}\"))\n    )\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nN = 3,000\n\n\n\n\nreading_time_home\n\n\n\n\n    Median (Q1, Q3)\n15 (5, 30)\n\n\n    Min, Max\n0, 120\n\n\nnaplan_reading_score\n\n\n\n\n    Median (Q1, Q3)\n562 (491, 619)\n\n\n    Min, Max\n177, 900\n\n\n\n\n\n\n\n\nnaplan %&gt;%\n  filter(gender == \"Female\", school_type == \"Independent\") %&gt;%\n  arrange(desc(naplan_reading_score)) %&gt;%\n  slice_head(n = 10) %&gt;%\n  select(\n    `Student ID` = student_id,\n    `School ID` = school_id,\n    Grade = grade,\n    `Reading Time` = reading_time_home,\n    `Parent Education` = parent_education,\n    `School Type` = school_type,\n    Gender = gender,\n    `Birth Month` = birth_months,\n    `Number of Siblings` = n_siblings,\n    `SES Index` = ses_index,\n    `Reading Score` = naplan_reading_score\n  ) %&gt;%\n  mutate(\n    `Reading Score` = cell_spec(\n      `Reading Score`,\n      background = spec_color(`Reading Score`, option = \"viridis\", end = 0.95),\n      color = \"white\"\n    )\n  ) %&gt;%\n  kable(\n    format = \"html\",\n    align = \"c\",\n    booktabs = TRUE,\n    escape = FALSE,\n    caption = \"Naplan\"\n  ) %&gt;%\n  kable_styling(full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE, color = \"white\", background = \"gray35\") %&gt;%\n  column_spec(\n    1:10,\n    background = \"gray95\",\n    extra_css = \"border-left: 3px solid gray50; border-right: 3px solid gray50;\"\n  )  %&gt;%  footnote(general = \"SES Index represents ...\", general_title = \"\")\n\n\nNaplan\n\n\nStudent ID\nSchool ID\nGrade\nReading Time\nParent Education\nSchool Type\nGender\nBirth Month\nNumber of Siblings\nSES Index\nReading Score\n\n\n\n\n584\n1\nYear 9\n40\nCertificate/Diploma\nIndependent\nFemale\nSep\n1\n0.68\n900\n\n\n2425\n47\nYear 9\n50\nPostgraduate\nIndependent\nFemale\nAug\n2\n2.02\n866\n\n\n1007\n1\nYear 9\n25\nBachelor degree\nIndependent\nFemale\nApr\n0\n1.09\n831\n\n\n887\n1\nYear 7\n50\nBachelor degree\nIndependent\nFemale\nJul\n1\n0.85\n800\n\n\n2166\n2\nYear 7\n60\nBachelor degree\nIndependent\nFemale\nMay\n1\n2.40\n800\n\n\n2610\n23\nYear 9\n35\nBachelor degree\nIndependent\nFemale\nOct\n1\n1.44\n796\n\n\n305\n1\nYear 9\n35\nCertificate/Diploma\nIndependent\nFemale\nApr\n3\n0.46\n788\n\n\n1220\n47\nYear 9\n35\nCertificate/Diploma\nIndependent\nFemale\nJul\n5\n0.76\n782\n\n\n133\n47\nYear 9\n55\nYear 10 or below\nIndependent\nFemale\nSep\n3\n0.36\n780\n\n\n1383\n47\nYear 9\n30\nCertificate/Diploma\nIndependent\nFemale\nSep\n2\n1.53\n774\n\n\n\n SES Index represents ...",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Preparing Data for Tables</span>"
    ]
  },
  {
    "objectID": "chapter2.html",
    "href": "chapter2.html",
    "title": "3  How To Visualise Numerical Data",
    "section": "",
    "text": "We have learnt how to visualise data using tables, which are useful for both analysts and readers when examining a dataset.\nHowever, tables are not always the most effective way to quickly and intuitively understand patterns or trends in the data. This is where figures become valuable.\nIn this chapter, we will focus on different types of figures that can be used to represent quantitative variables. For plot interpretation, refer to the Inferential Statistics With R short course.\n\n4 Rice\n\nPhoto by Zhao Yangjun on Unsplash\nIn this chapter, we are going to explore the rice dataset.\n\n\n\nDescription of Data Set Variables\n\n\nNo\nVariable\nDescription\n\n\n\n\n1\nRef\nReference number\n\n\n2\nExpSite\nName of the site/farmer\n\n\n3\nYear\nRice sown in October and harvested the following year\n\n\n4\nExpName\nCombination of experiment site and year\n\n\n5\nSowingMethod\nFour sowing methods – Drill, Aerial, Delayed Permanent Water (DPW) and DryBC\n\n\n6\nRange\nReplicate identification number of the experiment (each treatment has 3 replicates)\n\n\n7\nRow\nRow identification number (1–24)\n\n\n8\nRep\nSame as Range\n\n\n9\nVariety\nVariety of rice\n\n\n10\nNitrogen\nNitrogen rates (kg N/ha) applied prior to Permanent Water (PW) and at Panicle Initiation (PI)\n\n\n11\nNGroup\nGroups representing different nitrogen rates\n\n\n12\nEstab\nPlant population at establishment (No./m²)\n\n\n13\nPI_DM\nWeight of dry matter at PI (g/m²)\n\n\n14\nPI_Tillers\nCount of tillers at PI (No./m²)\n\n\n15\nPI_NIR\nPercentage of nitrogen in tissue at PI (% N)\n\n\n16\nPI_N_Uptake\nNitrogen uptake at PI (kg N/ha)\n\n\n17\nPM_DM\nWeight of dry matter at physiological maturity (g/m²)\n\n\n18\nHarvTillers\nCount of tillers at PM (No./m²)\n\n\n19\nHI\nHarvest index (ratio of grain to total plant dry weight)\n\n\n20\nQuadYield\nQuad (hand-harvested) grain yield (t/ha at 14% moisture)\n\n\n21\nHeaderYield\nHeader (machine-harvested) grain yield (t/ha at 14% moisture)\n\n\n22\nLodging\nLodging score at harvest (1 = standing, 10 = fully lodged)\n\n\n23\nPlantHeight\nAverage plant height at harvest (cm)\n\n\n\n\n\nLoad the rice_data.CSV dataset yourself and store it as a dataframe called rice. Then answer the questions below.\n\n\n\n\n\n\n\n\n\n\nrice &lt;- read.csv(\"Data-sets/rice_data.csv\")\nstr(rice)\nrice &lt;- read.csv(\"Data-sets/rice_data.csv\")\nstr(rice)\n\n\n\n\n\n\nHow many variables are in the rice dataset? \nHow many observations are in the rice dataset? \nHow many categorical variables are there? (Hint: they may not be stored correctly…yet) \nHow many numerical variables are there? (Hint: they may not be stored correctly…yet) \nWhat type of variable has R stored them? \n\nYou may notice that some data cleaning is required.\nIn the middle of the Excel file (around row 1465), there is a blank row, followed by a repeated header row.\n\nrice[1465:1466,]\n\n     Ref Experiment.site Year Exp.name Sowing.method RANGE ROW REP Variety\n1465  NA                                                                  \n1466  NA Experiment site Year          Sowing method RANGE ROW REP Variety\n     Nitrogen N.group Estab..No.msq. PI.DM..g.msq. PI.Tillers..No.msq.\n1465                                                                  \n1466 Nitrogen         Estab (No/msq) PI DM (g/msq) PI Tillers (No/msq)\n     PI.NIR..N PI.N.uptake..kg.N.ha. PM.DM..g.msq. Harv.tillers..No.msq. HI\n1465                                                                       \n1466 PI NIR %N PI N uptake (kg N/ha) PM DM (g/msq) Harv tillers (No/msq) HI\n     Quad.Yield..t.ha..14.. Header.Yield..t.ha..14.. Lodging..10.flat.\n1465                                                                  \n1466 Quad Yield (t/ha@ 14%) Header Yield (t/ha@ 14%) Lodging (10=flat)\n     Plant.height..cm.\n1465                  \n1466 Plant height (cm)\n\n\nIn addition, there are several missing values in the dataset, which are denoted by “*”.\n\nsum(rice == \"*\", na.rm = TRUE)\n\n[1] 1527\n\n\nThere are a few different ways we can approach missing values. The first step is to identify the extent of missing data and then diagnose the issue. Is the data missing completely at random (MCAR), missing at random (MAR), or missing not at random (MNAR)? In other words, is the issue structural, or is it genuinely random?\nDepending on the type of missing data, we might consider:\n\ndeleting rows with missing values\nimputing missing values using the mean\nimputing missing values using MICE (Multivariate Imputation by Chained Equations)\n\nIn these short courses, imputation is beyond the scope of the material covered, so we will focus on deleting missing rows (with appropriate justification). To learn how to properly treat missing data, I recommend the Missing Data Imputation in R tutorial from Princeton.\nBefore exploring the missing data, let’s do a quick clean. There are some trailing whitespace issues in a few observations, and we also want to focus on the * entries and convert these to NA. We then filter out any blank rows and remove the repeated header row.\n\n\n\n\n\n\n\n\n\n\nlibrary (dplyr)\n\nclean_rice &lt;- rice %&gt;%\n  # Convert \"*\" to NA\n  mutate(across(where(is.character),\n                ~ na_if(.x, \"*\"))) %&gt;%\n  # Drop fully blank rows\n  filter(if_any(everything(), ~ !is.na(.x) & .x != \"\")) %&gt;%  \n  # Drop repeated header row\n  filter(Sowing.method != \"Sowing method\")  \nlibrary (dplyr)\n\nclean_rice &lt;- rice %&gt;%\n  # Convert \"*\" to NA\n  mutate(across(where(is.character),\n                ~ na_if(.x, \"*\"))) %&gt;%\n  # Drop fully blank rows\n  filter(if_any(everything(), ~ !is.na(.x) & .x != \"\")) %&gt;%  \n  # Drop repeated header row\n  filter(Sowing.method != \"Sowing method\")  \n\n\n\n\n\nLet’s visualise the missing values and count how many cells are missing.\n\nsapply(clean_rice, function(x) sum(is.na(x)))\n\n                     Ref          Experiment.site                     Year \n                     312                        0                        0 \n                Exp.name            Sowing.method                    RANGE \n                       0                        0                        0 \n                     ROW                      REP                  Variety \n                       0                        0                        0 \n                Nitrogen                  N.group           Estab..No.msq. \n                       0                        0                       73 \n           PI.DM..g.msq.      PI.Tillers..No.msq.                PI.NIR..N \n                      77                       77                       77 \n   PI.N.uptake..kg.N.ha.            PM.DM..g.msq.    Harv.tillers..No.msq. \n                      78                       25                       27 \n                      HI   Quad.Yield..t.ha..14.. Header.Yield..t.ha..14.. \n                      25                       25                      904 \n       Lodging..10.flat.        Plant.height..cm. \n                      86                       53 \n\n\n\nsum(is.na(clean_rice))\n\n[1] 1839\n\n\n\nlibrary(visdat)\nvis_miss(clean_rice)\n\n\n\n\n\n\n\n\nAll treatment variables are complete, while missing values mostly occur in the response and intermediate agronomic measurements. The main example is HeaderYield, which is missing for many observations because machine-harvest data were only collected at some sites. In other words, this is structural missing data i.e. the values do not exist for certain site–season combinations rather than being randomly missing. Because of this, it makes sense to drop HeaderYield NAs only when we are visualising or analysing HeaderYield.\nWe also see missing values in the reference number (Ref). This appears to be caused by a data import issue, where a blank row and a repeated header row were introduced in the middle of the dataset. After this point, the reference numbers are no longer populated. Since Ref is just an identifier, filling in these values would be inappropriate, so we do not attempt to impute them. Instead, the problematic rows can be removed where needed.\nFinally, for visualisation, we do not want to drop all rows that contain missing values, as this would remove valid data unnecessarily. Instead, for each plot, we only remove the missing values that are relevant to the variables being visualised.\nWe now continue cleaning the data accordingly.\n\n\n\n\n\n\n\n\n\n\nlibrary(tidyverse)\nlibrary(stringr)\n\nclean_rice &lt;- clean_rice %&gt;%\n  mutate(across(where(is.character), str_squish)) %&gt;%\n  mutate(across(\n    c(\n      Ref, Experiment.site, Year, Exp.name, Sowing.method,\n      RANGE, ROW, REP, Variety, Nitrogen, N.group, Lodging..10.flat.\n    ),\n    as.factor\n  )) %&gt;%\n  mutate(across(where(is.character), as.numeric)) \nlibrary(tidyverse)\nlibrary(stringr)\n\nclean_rice &lt;- clean_rice %&gt;%\n  mutate(across(where(is.character), str_squish)) %&gt;%\n  mutate(across(\n    c(\n      Ref, Experiment.site, Year, Exp.name, Sowing.method,\n      RANGE, ROW, REP, Variety, Nitrogen, N.group, Lodging..10.flat.\n    ),\n    as.factor\n  )) %&gt;%\n  mutate(across(where(is.character), as.numeric)) \n\n\n\n\n\nLet’s check the structure again to make sure everything has been cleaned up correctly.\n\n\n\n\n\n\n\n\n\n\nstr(clean_rice)\nstr(clean_rice)\n\n\n\n\n\nYay! Now that the dataset is cleaned, we’re ready to start plotting.\n\nOne Quantitative Variable\nWhen you have a single numerical variable, whether discrete or continuous, a histogram is a great way to visualise its distribution.\nIn R, you can create plots using base R. For example, to see a visualisation of plant height, you can simply type:\n\nhist(clean_rice$Plant.height..cm.)\n\n\n\n\n\n\n\n\nto generate a histogram.\nWhile base R plots are fine for basic analysis,ggplot2 is one of the most commonly used plotting packages and is widely accepted in published reports.\nThe histogram looks a bit plain without any color, and the x-axis label isn’t very informative. Let’s add some color, fix the labels, and give it a clean white background.\nLoad in the package and then run the code below.\n\nattach(clean_rice)\n\n\n\n\n\n\n\n\n\n\n\nlibrary(ggplot2)\n\nggplot(data=clean_rice, aes(x=Plant.height..cm.))+\n  geom_histogram(fill=\"palegreen3\", col=\"darkgreen\", bins=30)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+\n  theme_bw()\nlibrary(ggplot2)\n\nggplot(data=clean_rice, aes(x=Plant.height..cm.))+\n  geom_histogram(fill=\"palegreen3\", col=\"darkgreen\", bins=30)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+\n  theme_bw()\n\n\n\n\n\nWe can see that this is much better!\n\nIf you see an NA warning when creating this histogram in RStudio, don’t worry. R automatically excludes these values from the plot. To avoid the warning, we can explicitly drop the NAs for the variable in the pipeline, as shown below:\n\nclean_rice %&gt;%\n  drop_na(Plant.height..cm.) %&gt;%\n  ggplot(aes(x = Plant.height..cm.)) +\n  geom_histogram(fill = \"palegreen3\", col = \"darkgreen\", bins = 30) +\n  labs(x = \"Rice Plant Height (cm)\", y = \"Frequency\") +\n  theme_bw()\n\n\n\n\n\n\n\n\nIt is very important that when creating a plot, you provide meaningful labels with units. You can also see below how different bin choices influence the histogram.\n\nggplot(data=clean_rice, aes(x=Plant.height..cm.))+\n  geom_histogram(fill=\"palegreen3\", col=\"darkgreen\", bins=10)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(data=clean_rice, aes(x=Plant.height..cm.))+\n  geom_histogram(fill=\"palegreen3\", col=\"darkgreen\", bins=100)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can make the histogram even more informative by filling the bars by sowing method. Do plant heights differ between different sowing methods?\n\nggplot(data=clean_rice, aes(x=Plant.height..cm., fill=Sowing.method))+\n  geom_histogram(binwidth=2)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+ \n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(data=clean_rice, aes(x=Plant.height..cm., col=Sowing.method))+\n  geom_freqpoly(binwidth=2)+\n  labs(x=\"Rice Plant Height (cm)\", y=\"Frequency\")+ \n  theme_bw()\n\n\n\n\n\n\n\n\n\n\nTwo Quantitative Variables\nWhen working with two quantitative variables, scatterplot is a suitable choice.\nFill in the blanks below to create a plot of dry matter at PI against plant height.\n\n\n\n\n\n\n\n\n\n\nggplot(data=clean_rice, aes(x=PI.DM..g.msq., y=Plant.height..cm.))+\n  geom_point(fill=\"darkolivegreen3\", col=\"darkolivegreen\", pch=21, size=3)+\n  labs(x=expression(\"Weight of Dry Matter at PI (\"*g/m^2*\")\"),y=\"Rice Plant Height (cm)\")+\n  geom_smooth(method=\"lm\", col=\"black\")+\n  theme_bw()\nggplot(data=clean_rice, aes(x=PI.DM..g.msq., y=Plant.height..cm.))+\n  geom_point(fill=\"darkolivegreen3\", col=\"darkolivegreen\", pch=21, size=3)+\n  labs(x=expression(\"Weight of Dry Matter at PI (\"*g/m^2*\")\"),y=\"Rice Plant Height (cm)\")+\n  geom_smooth(method=\"lm\", col=\"black\")+\n  theme_bw()\n\n\n\n\n\nWe can see that as the weight of the dry matter increases, the plant height also slightly increases. This suggests a weak to moderate positive linear relationship. Looking for more details on understanding linear relationships? Check out the Inferential Statistics with R and Linear Regression short courses!\nTo visualise the linear relationship, we include method = \"lm\" in geom_smooth(), which fits a linear model (a straight line) to the data.\n\nggplot(data=clean_rice, aes(x=PI.DM..g.msq., y=Plant.height..cm.))+\n  geom_point(fill=\"darkolivegreen3\", col=\"darkolivegreen\", pch=21, size=3)+\n  labs(x=expression(\"Weight of Dry Matter at PI (\"*g/m^2*\")\"),y=\"Rice Plant Height (cm)\")+\n  geom_smooth(method=\"lm\", col=\"black\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can customise the scatterplot even further by using the mapping argument to colour the points by species type.\n\nclean_rice %&gt;%\n  drop_na(Sowing.method) %&gt;%\n  ggplot(aes(\n    x = PI.DM..g.msq.,\n    y = Plant.height..cm.,\n    colour = Sowing.method,\n    fill   = Sowing.method,\n  )) +\n  geom_point(size = 3) +\n  labs(\n    x = expression(\"Weight of Dry Matter at PI (\"*g~m^-2*\")\"),\n    y = \"Rice Plant Height (cm)\"\n  ) +\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\nQuantitative and Qualitative Variables\nYou may also want to create plots that compare quantitative and qualitative variables. For example, does plant height differ between rice varieties? How does header yield vary across sowing methods? In these cases, a boxplot is a useful way to visualise the relationship.\nFill in the blanks below to create a boxplot showing plant height (Plant.height..cm.) across groups representing different nitrogen rates (N.group).\n\n\n\n\n\n\n\n\n\n\nclean_rice$N.group &lt;- factor(\n  clean_rice$N.group,\n  levels = c(\"zero\", \"PW_1\", \"PW_2\", \"PW_3\", \"split\", \"split 2\", \"split 3\")\n)\n\nggplot(clean_rice, aes(x=N.group, y=Plant.height..cm.))+\n  geom_boxplot(fill=\"#EF8354\", col=\"#DF3B57\")+\n  labs(x=\"Nitrogen Rate Group\",y=\"Rice Plant Height (cm)\")+\n  theme_bw()\nclean_rice$N.group &lt;- factor(\n  clean_rice$N.group,\n  levels = c(\"zero\", \"PW_1\", \"PW_2\", \"PW_3\", \"split\", \"split 2\", \"split 3\")\n)\n\nggplot(clean_rice, aes(x=N.group, y=Plant.height..cm.))+\n  geom_boxplot(fill=\"#EF8354\", col=\"#DF3B57\")+\n  labs(x=\"Nitrogen Rate Group\",y=\"Rice Plant Height (cm)\")+\n  theme_bw()\n\n\n\n\n\nYou can also customise even further.\n\nggplot(\n  clean_rice,\n  aes(x = N.group, y = Plant.height..cm., fill = N.group, colour = N.group)\n) +\n  geom_boxplot(col=\"black\") +\n  facet_wrap(~ Sowing.method) +\n  scale_fill_manual(values =  c(\n  \"#D8A47F\",\n  \"#EF8354\",\n  \"#EE4B6A\",\n  \"#C57A44\",\n  \"#EA5C1F\",\n  \"#EA1F44\",\n  \"#0F7173\")) +\n  labs(\n    x = \"Nitrogen rate group\",\n    y = \"Rice plant height (cm)\",\n    title = \"Rice Plant Heights vs. Nitrogen Rate by Sowing Method\"\n  ) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nTry creating a boxplot of Header Yield (machine-harvested grain yield, tonnes per hectare at 14% moisture) versus sowing method on your own, and customise it to your liking.\n\n\nShow code\n\n\nclean_rice %&gt;%\n  drop_na(Header.Yield..t.ha..14..) %&gt;%\nggplot(aes(x = Sowing.method, y = Header.Yield..t.ha..14.., fill = Sowing.method, \n                 colour = Sowing.method)) +\n  geom_boxplot() +\n  scale_fill_manual(values = c(\"#A05475\", \"#EE586C\", \"#6B5C8A\")) +\n  scale_colour_manual(values = c(\"#3B1F2B\", \"#D8162F\", \"#3F355F\")) +\n  labs(x = \"Sowing Method\", y = \"Header Yield (Tonnes per Hectare*)\",\n       title=\"Sowing Method vs. Header Yield by Nitrogen Group\",\n       caption = \"*At 14% Moisture\") +\n  theme_classic() +\n  facet_wrap(~N.group)\n\n\n\n\n\n\n\n\n\n\ndetach(clean_rice)\n\n\n\n\n5 Palmer Penguins\n\nlibrary(palmerpenguins)\n\nsum(is.na(penguins))\n\n[1] 19\n\nnrow(penguins)\n\n[1] 344\n\n\n\n\n\n\n\n\n\n\n\n\nlibrary(ggplot2)\nlibrary(tidyverse)\n\nclean_penguins &lt;- na.omit(penguins)\n\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram(fill=\"orangered\", bins=30) +\n  labs(x=\"Body Mass of Penguins (g)\")+\n  theme_bw()\nlibrary(ggplot2)\nlibrary(tidyverse)\n\nclean_penguins &lt;- na.omit(penguins)\n\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram(fill=\"orangered\", bins=30) +\n  labs(x=\"Body Mass of Penguins (g)\")+\n  theme_bw()\n\n\n\n\n\n\n# Load the library\n\nlibrary(ggplot2)\nlibrary(palmerpenguins)\nclean_penguins &lt;- na.omit(penguins)\n\n# We can plot the histogram\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram()\n\n\n\n\n\n\n\n\n\n# We can plot the histogram\nggplot(clean_penguins, aes(x=body_mass_g))+\n  geom_histogram(fill=\"orangered\", bins=30) +\n  labs(x=\"Body Mass of Penguins (g)\")+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(penguins, aes(body_mass_g, fill = species)) +\n  geom_histogram(binwidth = 100)\n\n\n\n\n\n\n\n\n\nggplot(penguins, aes(body_mass_g, colour = species)) +\n  geom_freqpoly(binwidth = 100)\n\n\n\n\n\n\n\n\n\nggplot(penguins, aes(body_mass_g, after_stat(density), colour = species)) +\n  geom_freqpoly(binwidth = 100)\n\n\n\n\n\n\n\n\n\nScatterplots\nWhat if we’re interested in how body mass relates to flipper length? In this case, we’re working with two continuous numerical variables, so a scatterplot would be a good choice.\n\nggplot(clean_penguins, aes(x=body_mass_g, y=flipper_length_mm))+\n  geom_point()\n\n\n\n\n\n\n\n\nLike we did with the histogram, we can add color, change the shape of the points, and include informative labels.\n\nggplot(clean_penguins, aes(x=body_mass_g, y=flipper_length_mm))+\n  geom_point(fill=\"aquamarine\", col=\"aquamarine4\", pch=21, size=2.5)+\n  labs(x=\"Body Mass of Penguins (g)\", y=\"Flipper Length of Penguins (mm)\")+\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can see that as the body mass of a penguin increases, its flipper length also tends to increase. This suggests a strong positive linear relationship.\nWe can customise the scatterplot even further by using the mapping argument to colour the points by species type. To visualise the linear relationship, we include method = \"lm\" in geom_smooth(), which fits a linear model (a straight line) to the data.\n\nggplot(\n  penguins,\n  mapping = aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(mapping = aes(color = species)) +\n  geom_smooth(method = \"lm\")\n\n\n\n\n\n\n\n\n\nggplot(\n  data = penguins,\n  mapping = aes(x = flipper_length_mm, y = body_mass_g)\n) +\n  geom_point(mapping = aes(color = species, shape = species)) +\n  geom_smooth(method = \"lm\") +\n  scale_color_manual(\n    values = c(\n      Adelie = \"#03045e\",\n      Chinstrap = \"#0096c7\",\n      Gentoo = \"#90e0ef\"\n    )\n  )\n\n\n\n\n\n\n\n\n\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(aes(color = species, shape = island)) +\n  scale_colour_brewer(palette = \"Set1\")\n\n\n\n\n\n\n\n\n\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(aes(color = species, shape = species)) +\n  facet_wrap(~island) +\n  scale_colour_viridis_d()\n\n\n\n\n\n\n\n\nColour blind\n\nlibrary(ggthemes)\nggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_point(aes(color = species, shape = species)) +\n  facet_wrap(~island) +\n  scale_colour_colorblind()\n\n\n\n\n\n\n\n\n\nlibrary(\"scales\")\n\nshow_col(colorblind_pal()(8))",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>How To Visualise Numerical Data</span>"
    ]
  }
]