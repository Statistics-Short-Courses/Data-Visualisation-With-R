---
title: "Categorical Data"
format: 
  live-html:
    toc: true
resources: 
  - "Data-sets"
  
execute:
  echo: true
  warning: false
  message: false

webr:
  editor: true
  render-df: gt-interactive
    
embed-resources: true

filters:
  - custom-numbered-blocks

custom-numbered-blocks:
  classes:
    Assumption:
      colors: [FFCDD2, F44336]
      boxstyle: foldbox.simple
      collapse: false
    Example:
      colors: [BBDEFB, 2196F3]
      boxstyle: foldbox.simple
      collapse: false
    Exercise:
      colors: [C8E6C9, 4CAF50]
      boxstyle: foldbox.simple
      collapse: false
    Technical-point:
      colors: [FFF9C4, FFEB3B]
      boxstyle: foldbox.simple
      collapse: true
---

{{< include ./_extensions/r-wasm/live/_knitr.qmd >}}

{{< include ./_extensions/r-wasm/live/_gradethis.qmd >}}

## Palmer Penguins 

Continuing on with the `penguins` dataset, we will explore plots that only contain categorical variables. 


### One Categorical Variable

Since we were looking at species in the previous chapter, let's take a look at how many penguins were observed in each species. Because we're dealing with one categorical variable, a **bar plot** is appropriate.

```{webr}
#| exercise: ex_3.1.0
#| envir: Ex1
#| warning: false
#| message: false

# Load in ggplot2

# Load in tidyverse

# Load in palmerpenguins 

# Create the `clean_penguins` dataframe with missing observations omitted

# Run the code below 

ggplot(clean_penguins, aes(x = species)) +
  geom_bar(fill = c("coral2", "chartreuse2", "cadetblue2"),
               col = c("coral3", "chartreuse4", "cadetblue4")) +
  labs(x = "Penguin Species", y = "Count") +
  theme_bw()

```

```{webr}
#| exercise: ex_3.1.0
#| solution: true
#| envir: Ex1

library(ggplot2)

library(tidyverse)

library(palmerpenguins)

clean_penguins <- na.omit(penguins)

ggplot(clean_penguins, aes(x = species)) +
  geom_bar(fill = c("coral2", "chartreuse2", "cadetblue2"),
               col = c("coral3", "chartreuse4", "cadetblue4")) +
  labs(x = "Penguin Species", y = "Count") +
  theme_bw()

```

```{webr}
#| exercise: ex_3.1.0
#| check: true
#| class: wait
#| envir: Ex1
gradethis::grade_this_code()
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)

library(tidyverse)

library(palmerpenguins)

clean_penguins <- na.omit(penguins)
```

```{r, eval=FALSE, echo=FALSE}
ggplot(clean_penguins, aes(x = species)) +
  geom_bar(fill = c("coral2", "chartreuse2", "cadetblue2"),
               col = c("coral3", "chartreuse4", "cadetblue4")) +
  labs(x = "Penguin Species", y = "Count") +
  theme_bw()

```

We can also explore proportions to understand how each species contributes to the total sample.

Adelie penguins make up a much larger proportion of the sample, while Chinstrap penguins account for the smallest. It's important to consider how such imbalances in your dataset could influence your interpretation.

We can generate a **mosaic plot** for species. To do so, we will need to install `ggmosaic`.

```{r, message=FALSE, warning = FALSE}
library(ggmosaic)

ggplot(data=clean_penguins, aes(col=species))+
  geom_mosaic(aes(x=product(species)), fill=c("coral2", "chartreuse2", "cadetblue2"))+
  theme_bw() 
```

The wider the tile, the greater the proportion that species contributes. Adelie has the widest tile, which confirms it makes up the largest share of the sample.

### Two Categorical Variables

What if we want to look at penguin species by the island where they were observed? We are now dealing with two categorical variables. We can consider a grouped barchart:

```{r}
ggplot(clean_penguins, aes(x = island, fill = species)) +
  geom_bar(position = "dodge")

```

Or stacked:

```{r}
table(clean_penguins$species, clean_penguins$island)
```


```{r}
ggplot(clean_penguins, aes(x = island, fill = species)) +
  geom_bar(position = "stack")
```


Mosaic plots work well here too.

```{r, warning = FALSE}
ggplot(clean_penguins) +
  geom_mosaic(aes(x = product(species, island)), 
              fill = rep(c("coral2", "chartreuse2", "cadetblue2"),3)) +
  theme_bw()
```

From these plots you can see:

-   Adelie appear on Biscoe, Dream, and Torgersen in roughly similar counts.

-   Chinstrap are observed only on Dream.

-   Gentoo are observed only on Biscoe.

These patterns help explain why Adelie dominate overall, and they also show that species presence varies by island.




## Exercise

1.  Now that you are more comfortable generating plots and summary statistics in R, it is a good time to test your skills on a new dataset, the built-in **iris** dataset. This dataset is already preloaded in RStudio, so there is no need to import anything.

To make sure it is available, you can view it by running

```{r, echo=FALSE}
library(webexercises)
```

```{r, eval=FALSE}
View(iris)
```

This will open the dataset in a new tab in RStudio so you can explore its structure and variables before starting your analysis.

How many variables are in the `iris` dataset? `r fitb(5)`

How many observations are in the `iris` dataset? `r fitb(150)`

How many categorical variables are in the `iris` dataset? `r fitb(1)`

How many numerical variables are in the `iris` dataset? `r fitb(4)`

How many species are in the `iris` dataset? `r fitb(3)`

What are the names of the three species in the `iris` dataset? Please list them in **alphabetical order**, separated by commas (for example: `x, y, z`) `r fitb("setosa, versicolor, virginica", ignore_case = TRUE, ignore_ws = TRUE, regex=TRUE)`

Is `Species` nominal or ordinal? `r fitb("nominal", ignore_case = TRUE, ignore_ws = TRUE, regex=TRUE)`

Is `Sepal.Length` continuous or discrete? `r fitb("continuous", ignore_case = TRUE, ignore_ws = TRUE, regex=TRUE)`

What is the mean sepal width of iris varieties rounded to one decimal place? `r fitb(3.1)`

What is an appropriate plot to visualise petal width against species? `r fitb("boxplot", ignore_case = TRUE, ignore_ws = TRUE, regex=TRUE)`

What is an appropriate plot to visualise petal width against sepal width? `r fitb("scatterplot", ignore_case = TRUE, ignore_ws = TRUE, regex=TRUE)`


